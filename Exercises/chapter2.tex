\part{Foundations}

\chapter{Probabilistic Inference}

\begin{exercise}
\item Bayes rule for medical diagnosis
	\par\smallskip
	After your yearly checkup, the doctor has bad news and good news. The bad news is that you tested
	positive for a serious disease, and the test is \(99\%\) accurate (i.e., the probability of testing positive
	given that you have the disease is \(0.99\), as is the probability of testing negative given that you dont
	have the disease). The good news is that this rare disease, striking only one in \(10,000\) people.
	What are the chances that you actually have the disease?
	\par\smallskip
	The probability matrix will be given by \cref{ch2_ex1}.
	\begin{table}
	\centering
		\begin{tabular}{l | c c}
			& Y = 0 & Y = 1\\ \hline
			H = 0 & 0.99 & 0.01\\
			H = 1 & 0.01 & 0.99
		\end{tabular}
		\caption{The probability matrix for the given rare disease.}
		\label{ch2_ex1}
	\end{table}
	The probability of the prevalence of the disease is \(p(H = 1) = 1 / 10000\) for the population. The 
	probability that we are infected  and tested positive is
	\begin{align}
		p(H = 1\mid Y = 1) 
		&= \frac{p(Y = 1\mid H = 1) p(H = 1)}{p(Y = 1\mid H = 1) p(H = 1) + p(Y = 1\mid H = 0) p(H = 0)}
		\notag\\
		&= \frac{0.99\cdot 0.0001}{0.99\cdot 0.0001 + 0.01 \cdot (1 - 0.0001)}\notag\\
		&= 0.0098\text{ or } 0.98\%\notag
	\end{align}
\item Legal reasoning
	\par\smallskip
	Suppose a crime has been committed. Blood is found at the scene for which there is no innocent explanation.
	It is of a type which is present in \(1\%\) of the population.
	\begin{exercise}
		\item
			The prosecutor claims: "There is a \(1\%\) chance that the defendant would have the crime blood type if he
			were innocent. Thus there is a \(99\%\) chance he is guilty." This is known as the prosecutor's fallacy.
			What is wrong with this argument?
			\par\smallskip
			We are given that the probability of prevalence is \(P(H = 1) = 0.01\) so \(P(H = 0) = 0.99\). Moreover, the
			the number of people in the community with this rare blood type is \(8,000\) and there is no innocent
			explanation for it. That is, the true negative rate, or the probability that person doesn't have this blood
			and is not guilty is \(1\).
			\begin{table}
			\centering
				\begin{tabular}{l | c c}
					& Y = 0 & Y = 1\\ \hline
					H = 0 & 1 & 0\\
					H = 1 & 7999 / 8000 & 1 / 8000
				\end{tabular}
				\caption{The probability matrix for guilty and rare blood and vice versa.}
				\label{ch2_ex21}
			\end{table}
			From the probability matrix in \cref{ch2_ex21}, we have that true negative rate is \(100\%\) and the true 
			positive rate is \(1 / 8000\) for the given blood type; therefore, the probability that we are guilty with the
			rate blood type is
			\begin{align}
				p(H = 1\mid Y = 1) 
				&= \frac{p(Y = 1\mid H = 1) p(H = 1)}{p(Y = 1\mid H = 1) p(H = 1) + p(Y = 1\mid H = 0) p(H = 0)}
				\notag\\
				&= \frac{1 / 8000\cdot 1 / 100}{1 / 8000\cdot 1 / 100 + 7999 / 8000 \cdot 99 / 100}\notag\\
				&\approx 0.000126\%\notag
			\end{align}
		\item
			The defender claims: "The crime occurred in a city of \(800,000\) people. The blood type would found in
			approximately \(8,000\) people. The evidence has provided a probability of just \(1\) in \(8,000\) that the
			defendant is guilty, and thus has no relevance." This is known as the defender's fallacy. 
			What is wrong with this argument?
			\par\smallskip
			As for the defenders argument, the probability the defendant has the rare blood and is not guilty is
			\begin{align}
				p(H = 1\mid Y = 0) 
				&= \frac{p(Y = 0\mid H = 1) p(H = 1)}{p(Y = 0\mid H = 1) p(H = 1) + p(Y = 0\mid H = 0) p(H = 0)}
				\notag\\
				&= \frac{7999 / 8000\cdot 1 / 100}{7999 / 8000\cdot 1 / 100 + 1 \cdot 99 / 100}\notag\\
				&\approx 1\%\notag
			\end{align}
			That is, \(p(H = 1\mid Y = 0) \approx 1\% > 1 / 8000 = 0.0125\%\).
	\end{exercise}
\end{exercise}

